


Epoch #1: 1000it [00:30, 32.42it/s, env_step=1000, len=24, loss/critic=5316.320, n/ep=40, n/st=1000, overall_loss=0.003, rew=-1799.64]
Epoch #2:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]


Epoch #2: 1000it [00:30, 32.84it/s, env_step=2000, len=24, loss/critic=14837.847, n/ep=40, n/st=1000, overall_loss=0.003, rew=-1174.23]
Epoch #3:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]


Epoch #3: 1000it [00:29, 33.97it/s, env_step=3000, len=24, loss/critic=22635.430, n/ep=40, n/st=1000, overall_loss=0.002, rew=-892.22]
Epoch #4:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]


Epoch #4: 1000it [00:28, 120.71it/s]
Epoch #4: 1000it [00:28, 34.81it/s, env_step=4000, len=24, loss/critic=27237.677, n/ep=40, n/st=1000, overall_loss=0.003, rew=-772.72]



Epoch #5: 1000it [00:31, 32.19it/s, env_step=5000, len=24, loss/critic=33035.586, n/ep=40, n/st=1000, overall_loss=0.002, rew=-787.82]
Epoch #5: test_reward: -1202.291531 ± 0.000000, best_reward: -607.726564 ± 0.000000 in #3


Epoch #6: 1000it [00:29, 34.03it/s, env_step=6000, len=24, loss/critic=37408.384, n/ep=50, n/st=1000, overall_loss=0.002, rew=-634.04]
Epoch #7:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]



Epoch #7: 1000it [00:31, 31.35it/s, env_step=7000, len=24, loss/critic=38774.706, n/ep=40, n/st=1000, overall_loss=0.001, rew=-669.70]
Epoch #7: test_reward: -658.073348 ± 0.000000, best_reward: -607.726564 ± 0.000000 in #3


Epoch #8: 1000it [00:25, 120.63it/s]
Epoch #8: 1000it [00:30, 33.01it/s, env_step=8000, len=24, loss/critic=41849.109, n/ep=40, n/st=1000, overall_loss=0.002, rew=-650.21]


Epoch #9: 1000it [00:32, 30.57it/s, env_step=9000, len=24, loss/critic=43919.236, n/ep=40, n/st=1000, overall_loss=0.001, rew=-606.91]
Epoch #10:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #10: 1000it [00:31, 31.46it/s, env_step=10000, len=24, loss/critic=44215.906, n/ep=40, n/st=1000, overall_loss=0.002, rew=-598.01]
Epoch #11:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #11: 1000it [00:31, 31.71it/s, env_step=11000, len=24, loss/critic=46055.952, n/ep=40, n/st=1000, overall_loss=0.001, rew=-642.60]
Epoch #12:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #12: 1000it [00:28, 100.14it/s]
Epoch #12: 1000it [00:31, 31.89it/s, env_step=12000, len=24, loss/critic=49001.748, n/ep=50, n/st=1000, overall_loss=0.002, rew=-628.82]


Epoch #13: 1000it [00:30, 33.23it/s, env_step=13000, len=24, loss/critic=50590.158, n/ep=40, n/st=1000, overall_loss=0.001, rew=-612.64]
Epoch #14:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]



Epoch #14: 1000it [00:30, 32.95it/s, env_step=14000, len=24, loss/critic=52277.161, n/ep=40, n/st=1000, overall_loss=0.003, rew=-616.04]
Epoch #14: test_reward: -492.785814 ± 0.000000, best_reward: -382.502650 ± 0.000000 in #8


Epoch #15: 1000it [00:29, 34.36it/s, env_step=15000, len=24, loss/critic=52922.132, n/ep=40, n/st=1000, overall_loss=0.001, rew=-602.04]
Epoch #16:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #16: 1000it [00:29, 33.69it/s, env_step=16000, len=24, loss/critic=55907.382, n/ep=40, n/st=1000, overall_loss=0.003, rew=-588.25]
Epoch #17:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #17: 1000it [00:29, 33.52it/s, env_step=17000, len=24, loss/critic=58224.053, n/ep=40, n/st=1000, overall_loss=0.001, rew=-635.40]
Epoch #18:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]



Epoch #18: 1000it [00:30, 32.66it/s, env_step=18000, len=24, loss/critic=60496.315, n/ep=50, n/st=1000, overall_loss=0.003, rew=-624.43]
Epoch #18: test_reward: -671.941109 ± 0.000000, best_reward: -382.502650 ± 0.000000 in #8


Epoch #19: 1000it [00:30, 32.83it/s, env_step=19000, len=24, loss/critic=60876.659, n/ep=40, n/st=1000, overall_loss=0.001, rew=-589.49]
Epoch #20:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]

Epoch #20: 1000it [00:28, 34.81it/s, env_step=20000, len=24, loss/critic=66270.175, n/ep=40, n/st=1000, overall_loss=0.003, rew=-587.49]
Epoch #21:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #21: 1000it [00:29, 33.52it/s, env_step=21000, len=24, loss/critic=69617.531, n/ep=40, n/st=1000, overall_loss=0.001, rew=-594.00]
Epoch #22:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #22: 1000it [00:30, 32.56it/s, env_step=22000, len=24, loss/critic=71291.792, n/ep=40, n/st=1000, overall_loss=0.003, rew=-547.62]
Epoch #23:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #23: 1000it [00:28, 35.31it/s, env_step=23000, len=24, loss/critic=70754.296, n/ep=40, n/st=1000, overall_loss=0.001, rew=-610.99]
Epoch #24:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #24: 1000it [00:29, 33.86it/s, env_step=24000, len=24, loss/critic=75370.619, n/ep=50, n/st=1000, overall_loss=0.003, rew=-571.79]
Epoch #25:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]



Epoch #25: 1000it [00:30, 32.44it/s, env_step=25000, len=24, loss/critic=76912.051, n/ep=40, n/st=1000, overall_loss=0.002, rew=-545.12]
Epoch #25: test_reward: -479.251020 ± 0.000000, best_reward: -379.042354 ± 0.000000 in #23


Epoch #26: 1000it [00:28, 34.79it/s, env_step=26000, len=24, loss/critic=78468.588, n/ep=40, n/st=1000, overall_loss=0.003, rew=-557.51]
Epoch #27:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #27: 1000it [00:27, 36.24it/s]
Traceback (most recent call last):
  File "main.py", line 109, in <module>
    result = offpolicy_trainer(
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/offpolicy.py", line 133, in offpolicy_trainer
    return OffpolicyTrainer(*args, **kwargs).run()
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/base.py", line 441, in run
    deque(self, maxlen=0)  # feed the entire iterator into a zero-length deque
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/base.py", line 299, in __next__
    self.policy_update_fn(data, result)
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/offpolicy.py", line 122, in policy_update_fn
    losses = self.policy.update(self.batch_size, self.train_collector.buffer)
  File "/lxy/energydiffusion/policy/diffusion_opt.py", line 107, in update
    result = self.learn(batch, **kwargs)
  File "/lxy/energydiffusion/policy/diffusion_opt.py", line 220, in learn
    bc_loss = self._update_bc(batch, update=False)
  File "/lxy/energydiffusion/policy/diffusion_opt.py", line 181, in _update_bc
    expert_actions = torch.Tensor([info["expert_action"] for info in batch.info]).to(self._device)
KeyboardInterrupt