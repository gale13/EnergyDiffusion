


Epoch #1: 1000it [00:30, 32.75it/s, env_step=1000, len=24, loss/critic=3803.545, n/ep=40, n/st=1000, overall_loss=0.007, rew=-2075.06]
Epoch #2:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]


Epoch #2: 1000it [00:30, 32.52it/s, env_step=2000, len=24, loss/critic=9916.092, n/ep=40, n/st=1000, overall_loss=0.006, rew=-1064.34]
Epoch #3:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]


Epoch #3: 1000it [00:29, 33.98it/s, env_step=3000, len=24, loss/critic=14527.441, n/ep=40, n/st=1000, overall_loss=0.005, rew=-933.45]
Epoch #4:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]



Epoch #4: 1000it [00:30, 32.99it/s, env_step=4000, len=24, loss/critic=19778.017, n/ep=40, n/st=1000, overall_loss=0.005, rew=-888.56]
Epoch #4: test_reward: -1114.934865 ± 0.000000, best_reward: -817.513295 ± 0.000000 in #3


Epoch #5: 1000it [00:27, 112.77it/s]
Epoch #5: 1000it [00:30, 33.01it/s, env_step=5000, len=24, loss/critic=25648.411, n/ep=40, n/st=1000, overall_loss=0.004, rew=-820.86]


Epoch #6: 1000it [00:29, 33.38it/s, env_step=6000, len=24, loss/critic=33157.706, n/ep=50, n/st=1000, overall_loss=0.004, rew=-768.01]
Epoch #7:   0%|                                                                                                                 | 0/100 [00:00<?, ?it/s]


Epoch #7: 1000it [00:26, 120.17it/s]
Epoch #7: 1000it [00:29, 34.25it/s, env_step=7000, len=24, loss/critic=39582.855, n/ep=40, n/st=1000, overall_loss=0.004, rew=-644.09]



Epoch #8: 1000it [00:29, 33.81it/s, env_step=8000, len=24, loss/critic=46999.769, n/ep=40, n/st=1000, overall_loss=0.004, rew=-629.31]
Epoch #8: test_reward: -556.577393 ± 0.000000, best_reward: -526.506917 ± 0.000000 in #6


Epoch #9: 1000it [00:30, 32.59it/s, env_step=9000, len=24, loss/critic=55099.488, n/ep=40, n/st=1000, overall_loss=0.004, rew=-622.85]
Epoch #10:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #10: 1000it [00:29, 33.46it/s, env_step=10000, len=24, loss/critic=63378.254, n/ep=40, n/st=1000, overall_loss=0.003, rew=-612.09]
Epoch #11:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #11: 1000it [00:29, 33.81it/s, env_step=11000, len=24, loss/critic=70841.547, n/ep=40, n/st=1000, overall_loss=0.003, rew=-553.29]
Epoch #12:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #12: 1000it [00:26, 121.31it/s]
Epoch #12: 1000it [00:28, 34.55it/s, env_step=12000, len=24, loss/critic=82403.508, n/ep=50, n/st=1000, overall_loss=0.003, rew=-587.03]


Epoch #13: 1000it [00:27, 119.43it/s]
Epoch #13: 1000it [00:29, 33.65it/s, env_step=13000, len=24, loss/critic=91314.175, n/ep=40, n/st=1000, overall_loss=0.003, rew=-638.22]



Epoch #14: 1000it [00:29, 34.18it/s, env_step=14000, len=24, loss/critic=99275.455, n/ep=40, n/st=1000, overall_loss=0.003, rew=-601.34]
Epoch #14: test_reward: -827.119577 ± 0.000000, best_reward: -511.865713 ± 0.000000 in #12


Epoch #15: 1000it [00:30, 32.60it/s, env_step=15000, len=24, loss/critic=108111.573, n/ep=40, n/st=1000, overall_loss=0.003, rew=-547.04]
Epoch #16:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]



Epoch #16: 1000it [00:33, 30.05it/s, env_step=16000, len=24, loss/critic=122435.866, n/ep=40, n/st=1000, overall_loss=0.003, rew=-598.66]
Epoch #17:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #17: 1000it [00:32, 30.36it/s, env_step=17000, len=24, loss/critic=132524.731, n/ep=40, n/st=1000, overall_loss=0.003, rew=-591.21]
Epoch #18:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]

Epoch #18: 1000it [00:29, 33.37it/s, env_step=18000, len=24, loss/critic=139698.071, n/ep=50, n/st=1000, overall_loss=0.003, rew=-559.49]
Epoch #19:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #19: 1000it [00:29, 34.33it/s, env_step=19000, len=24, loss/critic=148749.179, n/ep=40, n/st=1000, overall_loss=0.003, rew=-590.43]
Epoch #20:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #20: 1000it [00:28, 35.47it/s, env_step=20000, len=24, loss/critic=153496.676, n/ep=40, n/st=1000, overall_loss=0.003, rew=-511.62]
Epoch #21:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #21: 1000it [00:27, 37.01it/s, env_step=21000, len=24, loss/critic=156432.282, n/ep=40, n/st=1000, overall_loss=0.003, rew=-614.66]
Epoch #22:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #22: 1000it [00:27, 36.52it/s, env_step=22000, len=24, loss/critic=167042.057, n/ep=40, n/st=1000, overall_loss=0.003, rew=-542.42]
Epoch #23:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #23: 1000it [00:26, 115.84it/s]
Epoch #23: 1000it [00:28, 35.37it/s, env_step=23000, len=24, loss/critic=173397.235, n/ep=40, n/st=1000, overall_loss=0.003, rew=-488.34]

Epoch #24: 1000it [00:08, 121.15it/s]
Epoch #24: 1000it [00:28, 35.57it/s, env_step=24000, len=24, loss/critic=173876.150, n/ep=50, n/st=1000, overall_loss=0.003, rew=-501.86]



Epoch #25: 1000it [00:28, 35.08it/s, env_step=25000, len=24, loss/critic=183083.242, n/ep=40, n/st=1000, overall_loss=0.003, rew=-493.17]
Epoch #25: test_reward: -657.756073 ± 0.000000, best_reward: -374.752953 ± 0.000000 in #15


Epoch #26: 1000it [00:20, 121.67it/s]

Epoch #26: 1000it [00:27, 36.16it/s, env_step=26000, len=24, loss/critic=179097.025, n/ep=40, n/st=1000, overall_loss=0.003, rew=-522.03]


Epoch #27: 1000it [00:22, 122.40it/s]

Epoch #27: 1000it [00:27, 36.09it/s, env_step=27000, len=24, loss/critic=185565.241, n/ep=40, n/st=1000, overall_loss=0.003, rew=-547.32]


Epoch #28: 1000it [00:24, 122.18it/s]
Epoch #28: 1000it [00:27, 36.45it/s, env_step=28000, len=24, loss/critic=184947.777, n/ep=40, n/st=1000, overall_loss=0.003, rew=-543.37]

Epoch #29: 1000it [00:08, 122.39it/s]
Epoch #29: 1000it [00:26, 37.08it/s, env_step=29000, len=24, loss/critic=186001.911, n/ep=40, n/st=1000, overall_loss=0.003, rew=-513.67]


Epoch #30: 1000it [00:19, 121.93it/s]
Epoch #30: 1000it [00:27, 36.01it/s, env_step=30000, len=24, loss/critic=188062.017, n/ep=50, n/st=1000, overall_loss=0.003, rew=-538.04]


Epoch #31: 1000it [00:21, 121.63it/s]
Epoch #31: 1000it [00:27, 36.70it/s, env_step=31000, len=24, loss/critic=190040.512, n/ep=40, n/st=1000, overall_loss=0.003, rew=-515.23]


Epoch #32: 1000it [00:23, 122.08it/s]
Epoch #32: 1000it [00:27, 36.20it/s, env_step=32000, len=24, loss/critic=184333.940, n/ep=40, n/st=1000, overall_loss=0.003, rew=-544.09]

Epoch #33: 1000it [00:08, 122.13it/s]

Epoch #33: 1000it [00:27, 36.53it/s, env_step=33000, len=24, loss/critic=187524.771, n/ep=40, n/st=1000, overall_loss=0.003, rew=-496.97]


Epoch #34: 1000it [00:18, 121.71it/s]
Epoch #34: 1000it [00:26, 37.10it/s, env_step=34000, len=24, loss/critic=183570.990, n/ep=40, n/st=1000, overall_loss=0.003, rew=-508.64]


Epoch #35: 1000it [00:21, 122.32it/s]
Epoch #35: 1000it [00:27, 35.72it/s, env_step=35000, len=24, loss/critic=179563.316, n/ep=40, n/st=1000, overall_loss=0.003, rew=-542.25]


Epoch #36: 1000it [00:22, 119.61it/s]
Epoch #36: 1000it [00:27, 36.07it/s, env_step=36000, len=24, loss/critic=178254.194, n/ep=50, n/st=1000, overall_loss=0.003, rew=-480.54]


Epoch #37: 1000it [00:24, 122.74it/s]
Epoch #37: 1000it [00:27, 36.31it/s, env_step=37000, len=24, loss/critic=173520.459, n/ep=40, n/st=1000, overall_loss=0.003, rew=-510.36]


Epoch #38: 1000it [00:27, 36.76it/s, env_step=38000, len=24, loss/critic=176353.494, n/ep=40, n/st=1000, overall_loss=0.003, rew=-502.42]
Epoch #38: test_reward: -382.482278 ± 0.000000, best_reward: -301.402173 ± 0.000000 in #37


Epoch #39: 1000it [00:27, 36.59it/s, env_step=39000, len=24, loss/critic=169523.449, n/ep=40, n/st=1000, overall_loss=0.003, rew=-502.30]
Epoch #40:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #40: 1000it [00:21, 122.32it/s]
Epoch #40: 1000it [00:28, 35.33it/s, env_step=40000, len=24, loss/critic=169132.897, n/ep=40, n/st=1000, overall_loss=0.003, rew=-536.25]


Epoch #41: 1000it [00:23, 122.69it/s]
Epoch #41: 1000it [00:27, 36.09it/s, env_step=41000, len=24, loss/critic=162228.039, n/ep=40, n/st=1000, overall_loss=0.003, rew=-505.34]

Epoch #42: 1000it [00:08, 122.08it/s]
Epoch #42: 1000it [00:27, 35.86it/s, env_step=42000, len=24, loss/critic=162326.562, n/ep=50, n/st=1000, overall_loss=0.003, rew=-452.78]

Epoch #43: 1000it [00:27, 118.40it/s]
Epoch #43: 1000it [00:27, 36.10it/s, env_step=43000, len=24, loss/critic=157147.482, n/ep=40, n/st=1000, overall_loss=0.003, rew=-471.79]



Epoch #44: 1000it [00:27, 36.50it/s, env_step=44000, len=24, loss/critic=159107.882, n/ep=40, n/st=1000, overall_loss=0.003, rew=-457.43]
Epoch #44: test_reward: -432.504685 ± 0.000000, best_reward: -301.402173 ± 0.000000 in #37


Epoch #45: 1000it [00:21, 122.22it/s]
Epoch #45: 1000it [00:28, 35.53it/s, env_step=45000, len=24, loss/critic=153407.047, n/ep=40, n/st=1000, overall_loss=0.003, rew=-498.12]


Epoch #46: 1000it [00:22, 118.75it/s]
Epoch #46: 1000it [00:28, 35.36it/s, env_step=46000, len=24, loss/critic=149605.962, n/ep=40, n/st=1000, overall_loss=0.003, rew=-475.63]


Epoch #47: 1000it [00:24, 122.90it/s]
Epoch #47: 1000it [00:27, 36.27it/s, env_step=47000, len=24, loss/critic=149110.079, n/ep=40, n/st=1000, overall_loss=0.003, rew=-472.70]


Epoch #48: 1000it [00:26, 121.76it/s]
Epoch #48: 1000it [00:27, 35.81it/s, env_step=48000, len=24, loss/critic=154349.405, n/ep=50, n/st=1000, overall_loss=0.003, rew=-472.64]

Epoch #49: 1000it [00:08, 117.49it/s]
Epoch #49: 1000it [00:27, 36.38it/s, env_step=49000, len=24, loss/critic=147810.215, n/ep=40, n/st=1000, overall_loss=0.003, rew=-459.59]


Epoch #50: 1000it [00:20, 117.34it/s]
Epoch #50: 1000it [00:28, 35.60it/s, env_step=50000, len=24, loss/critic=144620.162, n/ep=40, n/st=1000, overall_loss=0.003, rew=-468.41]


Epoch #51: 1000it [00:22, 122.32it/s]
Epoch #51: 1000it [00:27, 36.16it/s, env_step=51000, len=24, loss/critic=142179.442, n/ep=40, n/st=1000, overall_loss=0.003, rew=-490.99]


Epoch #52: 1000it [00:24, 120.83it/s]
Epoch #52: 1000it [00:27, 36.12it/s, env_step=52000, len=24, loss/critic=146505.572, n/ep=40, n/st=1000, overall_loss=0.003, rew=-454.61]


Epoch #53: 1000it [00:26, 37.17it/s, env_step=53000, len=24, loss/critic=140959.077, n/ep=40, n/st=1000, overall_loss=0.003, rew=-456.86]
Epoch #53: test_reward: -532.127565 ± 0.000000, best_reward: -301.402173 ± 0.000000 in #37


Epoch #54: 1000it [00:27, 36.94it/s, env_step=54000, len=24, loss/critic=140890.488, n/ep=50, n/st=1000, overall_loss=0.003, rew=-438.09]
Epoch #55:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #55: 1000it [00:21, 122.88it/s]
Epoch #55: 1000it [00:25, 39.30it/s, env_step=55000, len=24, loss/critic=137279.051, n/ep=40, n/st=1000, overall_loss=0.003, rew=-473.89]


Epoch #56: 1000it [00:25, 121.50it/s]
Epoch #56: 1000it [00:27, 36.70it/s, env_step=56000, len=24, loss/critic=135630.053, n/ep=40, n/st=1000, overall_loss=0.003, rew=-413.25]

Epoch #57: 1000it [00:08, 117.22it/s]
Epoch #57: 1000it [00:26, 37.86it/s, env_step=57000, len=24, loss/critic=137836.547, n/ep=40, n/st=1000, overall_loss=0.003, rew=-445.93]


Epoch #58: 1000it [00:21, 122.80it/s]
Epoch #58: 1000it [00:27, 36.35it/s, env_step=58000, len=24, loss/critic=137063.979, n/ep=40, n/st=1000, overall_loss=0.003, rew=-446.64]


Epoch #59: 1000it [00:23, 121.80it/s]
Epoch #59: 1000it [00:27, 36.03it/s, env_step=59000, len=24, loss/critic=139014.344, n/ep=40, n/st=1000, overall_loss=0.003, rew=-440.95]


Epoch #60: 1000it [00:25, 120.98it/s]
Epoch #60: 1000it [00:27, 36.32it/s, env_step=60000, len=24, loss/critic=133473.920, n/ep=50, n/st=1000, overall_loss=0.003, rew=-402.81]


Epoch #61: 1000it [00:27, 36.66it/s, env_step=61000, len=24, loss/critic=135234.202, n/ep=40, n/st=1000, overall_loss=0.003, rew=-423.45]
Epoch #61: test_reward: -405.650180 ± 0.000000, best_reward: -301.402173 ± 0.000000 in #37


Epoch #62: 1000it [00:27, 36.06it/s, env_step=62000, len=24, loss/critic=138065.562, n/ep=40, n/st=1000, overall_loss=0.003, rew=-434.24]
Epoch #63:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #63: 1000it [00:27, 36.17it/s, env_step=63000, len=24, loss/critic=132930.898, n/ep=40, n/st=1000, overall_loss=0.003, rew=-443.70]
Epoch #64:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]


Epoch #64: 1000it [00:27, 35.95it/s, env_step=64000, len=24, loss/critic=141952.365, n/ep=40, n/st=1000, overall_loss=0.003, rew=-442.38]
Epoch #65:   0%|                                                                                                                | 0/100 [00:00<?, ?it/s]
Epoch #65:   0%|                                                                                                                | 0/100 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "main.py", line 109, in <module>
    result = offpolicy_trainer(
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/offpolicy.py", line 133, in offpolicy_trainer
    return OffpolicyTrainer(*args, **kwargs).run()
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/base.py", line 441, in run
    deque(self, maxlen=0)  # feed the entire iterator into a zero-length deque
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/base.py", line 288, in __next__
    data, result, self.stop_fn_flag = self.train_step()
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/trainer/base.py", line 384, in train_step
    result = self.train_collector.collect(
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/data/collector.py", line 314, in collect
    result = self.env.step(action_remap, ready_env_ids)  # type: ignore
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/env/venvs.py", line 284, in step
    self.workers[j].send(action[i])
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/tianshou/env/worker/dummy.py", line 38, in send
    self.result = self.env.step(action)  # type: ignore
  File "/lxy/energydiffusion/env/distEnergy.py", line 129, in step
    op,expert_action = convexprogram(Demand,Generate,Storage,self.Graph,Unitcost,self.a,self.b)
  File "/lxy/energydiffusion/env/distEnergy.py", line 41, in convexprogram
    res = prob.solve()
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/cvxpy/problems/problem.py", line 503, in solve
    return solve_func(self, *args, **kwargs)
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/cvxpy/problems/problem.py", line 1090, in _solve
    self.unpack_results(solution, solving_chain, inverse_data)
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/cvxpy/problems/problem.py", line 1405, in unpack_results
    solution = chain.invert(solution, inverse_data)
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/cvxpy/reductions/chain.py", line 84, in invert
    solution = r.invert(solution, inv)
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/cvxpy/reductions/dcp2cone/cone_matrix_stuffing.py", line 431, in invert
    dual_vars[old_con] = np.reshape(
  File "<__array_function__ internals>", line 200, in reshape
  File "/opt/conda/envs/gdmopt/lib/python3.8/site-packages/numpy/core/fromnumeric.py", line 298, in reshape
    return _wrapfunc(a, 'reshape', newshape, order=order)
KeyboardInterrupt